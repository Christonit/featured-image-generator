import OpenAI from 'openai';
import dotenv from 'dotenv';

dotenv.config();

const openai = new OpenAI({
    apiKey: process.env.CHATGPT_KEY
});

const IMAGE_LIST = [
    "3M Company.png",
    "A.O. Smith Corporation.png",
    "AFLAC Incorporated 1.png",
    "AMETEK, Inc..png",
    "ANSYS, Inc..png",
    "APA Corporation.png",
    "AT&T Inc..png",
    "AbbVie Inc..png",
    "Abbott Laboratories.png",
    "Accenture plc.png",
    "Activision Blizzard, Inc.png",
    "Adobe Inc..png",
    "Advance Auto Parts Inc..png",
    "Advanced Micro Devices, Inc..png",
    "Agilent Technologies, Inc. 1.png",
    "Air Products and Chemicals, Inc..png",
    "Akamai Technologies, Inc..png",
    "Alaska Air Group, Inc..png",
    "Albemarle Corporation.png",
    "Alexandria Real Estate Equities, Inc..png",
    "Align Technology, Inc..png",
    "Allegion plc.png",
    "Alliant Energy Corporation.png",
    "Allstate Corporation.png",
    "Alphabet Inc..png",
    "Amazon.com, Inc..png",
    "Amcor plc.png",
    "Ameren Corporation.png",
    "American Airlines Group, Inc..png",
    "American Electric Power Company, Inc..png",
    "American Express Company.png",
    "American International Group, Inc. New.png",
    "American Tower Corporation (REIT).png",
    "American Water Works Company, Inc..png",
    "Ameriprise Financial, Inc..png",
    "AmerisourceBergen Corporation.png",
    "Amgen Inc..png",
    "Amphenol Corporation.png",
    "Analog Devices, Inc..png",
    "Aon plc.png",
    "Apple Inc..png",
    "Applied Materials, Inc..png",
    "Aptiv PLC.png",
    "Arch Capital Group Ltd..png",
    "Archer-Daniels-Midland Company.png",
    "Arista Networks, Inc..png",
    "Arthur J. Gallagher & Co..png",
    "Assurant, Inc..png",
    "Atmos Energy Corporation.png",
    "AutoZone, Inc..png",
    "Autodesk, Inc..png",
    "Automatic Data Processing, Inc..png",
    "AvalonBay Communities, Inc..png",
    "Avery Dennison Corporation.png",
    "Axon Enterprise, Inc..png",
    "Baker Hughes Company.png",
    "Ball Corporation.png",
    "Bank of America Corporation.png",
    "Bath & Body Works, Inc..png",
    "Baxter International Inc..png",
    "Becton, Dickinson and Company.png",
    "Berkshire Hathaway Inc..png",
    "Best Buy Co., Inc..png",
    "Bio-Rad Laboratories, Inc..png",
    "Bio-Techne Corp.png",
    "Biogen Inc..png",
    "BlackRock, Inc..png",
    "Booking Holdings Inc. Common Stock.png",
    "BorgWarner Inc..png",
    "Boston Properties, Inc..png",
    "Boston Scientific Corporation.png",
    "Bristol-Myers Squibb Company.png",
    "Broadcom Inc..png",
    "Broadridge Financial Solutions, Inc..png",
    "Brown & Brown, Inc..png",
    "Brown Forman Inc.png",
    "Bunge Limited.png",
    "C.H. Robinson Worldwide, Inc..png",
    "CBRE Group Inc..png",
    "CDW Corporation.png",
    "CF Industries Holdings, Inc..png",
    "CME Group Inc..png",
    "CMS Energy Corporation.png",
    "CSX Corporation.png",
    "CVS Health Corporation.png",
    "Cadence Design Systems, Inc..png",
    "Caesars Entertainment, Inc..png",
    "Camden Property Trust.png",
    "Campbell Soup Company.png",
    "Capital One Financial Corporation.png",
    "CarMax Inc.png",
    "Cardinal Health, Inc..png",
    "Carnival Corporation.png",
    "Carrier Global Corporation.png",
    "Catalent, Inc..png",
    "Caterpillar, Inc..png",
    "Cboe Global Markets, Inc..png",
    "Celanese Corporation.png",
    "Centene Corporation.png",
    "CenterPoint Energy, Inc (Holding Co).png",
    "Ceridian HCM Holding Inc..png",
    "Charles River Laboratories International, Inc..png",
    "Charles Schwab Corporation.png",
    "Charter Communications, Inc..png",
    "Chevron Corporation.png",
    "Chipotle Mexican Grill, Inc..png",
    "Chubb Limited.png",
    "Church & Dwight Company, Inc..png",
    "Cincinnati Financial Corporation.png",
    "Cintas Corporation.png",
    "Cisco Systems, Inc..png",
    "Citigroup, Inc..png",
    "Citizens Financial Group, Inc..png",
    "CoStar Group, Inc..png",
    "Cognizant Technology Solutions Corporation.png",
    "Colgate-Palmolive Company.png",
    "Comcast Corporation.png",
    "Comerica Incorporated.png",
    "ConocoPhillips.png",
    "Consolidated Edison, Inc..png",
    "Constellation Brands, Inc..png",
    "Constellation Energy Corporation.png",
    "Copart, Inc..png",
    "Corning Incorporated.png",
    "Corteva, Inc..png",
    "Costco Wholesale Corporation.png",
    "Coterra Energy Inc..png",
    "Crown Castle Inc..png",
    "Cummins Inc..png",
    "D.R. Horton, Inc..png",
    "DBA Sempra.png",
    "DENTSPLY SIRONA Inc..png",
    "DTE Energy Company.png",
    "DXC Technology Company.png",
    "DaVita Inc..png",
    "Danaher Corporation.png",
    "Darden Restaurants, Inc..png",
    "Deere & Company.png",
    "Delta Air Lines, Inc..png",
    "Devon Energy Corporation.png",
    "DexCom, Inc..png",
    "Diamondback Energy, Inc..png",
    "Digital Realty Trust, Inc..png",
    "Discover Financial Services.png",
    "Dollar General Corporation.png",
    "Dollar Tree, Inc..png",
    "Dominion Energy, Inc..png",
    "Domino’s Pizza Inc.png",
    "Dover Corporation.png",
    "Dow Inc..png",
    "DuPont de Nemours, Inc..png",
    "Duke Energy Corporation.png",
    "EOG Resources, Inc.png",
    "EPAM Systems, Inc..png",
    "EQT Corporation.png",
    "Eastman Chemical Company.png",
    "Eaton Corporation, PLC.png",
    "Ecolab Inc..png",
    "Edison International.png",
    "Edwards Lifesciences Corporation.png",
    "Electronic Arts Inc..png",
    "Elevance Health, Inc..png",
    "Eli Lilly and Company.png",
    "Emerson Electric Company.png",
    "Enphase Energy, Inc..png",
    "Entergy Corporation.png",
    "Equifax, Inc..png",
    "Equinix, Inc..png",
    "Equity Residential.png",
    "Essex Property Trust, Inc..png",
    "Etsy, Inc..png",
    "Everest Group, Ltd..png",
    "Evergy, Inc..png",
    "Eversource Energy.png",
    "Exelon Corporation.png",
    "Expedia Group, Inc..png",
    "Expeditors International of Washington, Inc..png",
    "Extra Space Storage Inc.png",
    "Exxon Mobil Corporation.png",
    "F5, Inc..png",
    "FMC Corporation.png",
    "FactSet Research Systems Inc..png",
    "Fair Isaac Corporation.png",
    "Fastenal Company.png",
    "FedEx Corporation.png",
    "Federal Realty Investment Trust.png",
    "Fidelity National Information Services, Inc..png",
    "Fifth Third Bancorp.png",
    "First Solar, Inc..png",
    "FirstEnergy Corp..png",
    "Fiserv, Inc..png",
    "FleetCor Technologies, Inc..png",
    "Ford Motor Company.png",
    "Fortinet, Inc..png",
    "Fortive Corporation.png",
    "Fox Corporation.png",
    "Franklin Resources, Inc..png",
    "Freeport-McMoRan, Inc..png",
    "GE HealthCare Technologies Inc..png",
    "Garmin Ltd..png",
    "Gartner, Inc..png",
    "Gen Digital Inc..png",
    "Generac Holdings Inc..png",
    "General Dynamics Corporation.png",
    "General Electric Company.png",
    "General Mills, Inc..png",
    "General Motors Company.png",
    "Genuine Parts Company.png",
    "Gilead Sciences, Inc..png",
    "Global Payments Inc..png",
    "Globe Life Inc..png",
    "Goldman Sachs Group, Inc..png",
    "HCA Healthcare, Inc..png",
    "HP Inc..png",
    "Halliburton Company.png",
    "Hartford Financial Services Group, Inc..png",
    "Hasbro, Inc..png",
    "Healthpeak Properties, Inc..png",
    "Henry Schein, Inc..png",
    "Hess Corporation.png",
    "Hewlett Packard Enterprise Company.png",
    "Hilton Worldwide Holdings Inc..png",
    "Hologic, Inc..png",
    "Home Depot, Inc..png",
    "Honeywell International Inc..png",
    "Hormel Foods Corporation.png",
    "Host Hotels.png",
    "Howmet Aerospace Inc..png",
    "Humana Inc..png",
    "Huntington Bancshares Incorporated.png",
    "Huntington Ingalls Industries, Inc..png",
    "IDEX Corporation.png",
    "IDEXX Laboratories, Inc..png",
    "IQVIA Holdings, Inc..png",
    "Illinois Tool Works Inc..png",
    "Illumina, Inc..png",
    "Incyte Corporation.png",
    "Ingersoll Rand Inc..png",
    "Insulet Corporation.png",
    "Intel Corporation.png",
    "Intercontinental Exchange Inc..png",
    "International Business Machines Corporation.png",
    "International Flavors & Fragrances, Inc..png",
    "International Paper Company.png",
    "Intuit Inc..png",
    "Intuitive Surgical.png",
    "Invesco Ltd.png",
    "Invitation Homes Inc..png",
    "Iron Mountain Incorporated.png",
    "J.B. Hunt Transport Services, Inc..png",
    "JP Morgan Chase & Co..png",
    "Jack Henry & Associates, Inc..png",
    "Jacobs Solutions Inc..png",
    "Johnson & Johnson.png",
    "Johnson Controls International plc.png",
    "Juniper Networks, Inc..png",
    "KLA Corporation.png",
    "Kellogg Company.png",
    "Keurig Dr Pepper Inc..png",
    "KeyCorp.png",
    "Keysight Technologies Inc..png",
    "Kimberly-Clark Corporation.png",
    "Kimco Realty Corporation.png",
    "Kinder Morgan, Inc..png",
    "Kroger Company.png",
    "L3Harris Technologies, Inc..png",
    "LKQ Corporation.png",
    "Laboratory Corporation of America Holdings.png",
    "Lam Research Corporation.png",
    "Lamb Weston Holdings, Inc..png",
    "Las Vegas Sands Corp..png",
    "Leidos Holdings, Inc..png",
    "Lennar Corporation.png",
    "Lincoln National Corporation.png",
    "Linde plc.png",
    "Live Nation Entertainment, Inc..png",
    "Lockheed Martin Corporation.png",
    "Loews Corporation.png",
    "Lowe’s Companies, Inc..png",
    "LyondellBasell Industries NV.png",
    "M&T Bank Corporation.png",
    "MGM Resorts International.png",
    "MSCI Inc..png",
    "Marathon Oil Corporation.png",
    "Marathon Petroleum Corporation.png",
    "MarketAxess Holdings, Inc..png",
    "Marriott International.png",
    "Marsh & McLennan Companies, Inc..png",
    "Martin Marietta Materials, Inc..png",
    "Masco Corporation.png",
    "Mastercard Incorporated.png",
    "Match Group, Inc..png",
    "McCormick & Company, Incorporated.png",
    "McDonald’s Corporation.png",
    "McKesson Corporation.png",
    "Medtronic plc..png",
    "Merck & Company, Inc..png",
    "MetLife, Inc..png",
    "Meta Platforms, Inc..png",
    "Mettler-Toledo International, Inc..png",
    "Microchip Technology Incorporated.png",
    "Micron Technology, Inc..png",
    "Microsoft Corporation.png",
    "Mid-America Apartment Communities, Inc..png",
    "Moderna, Inc..png",
    "Mohawk Industries, Inc..png",
    "Molina Healthcare Inc.png",
    "Molson Coors Beverage Company.png",
    "Mondelez International, Inc..png",
    "Monolithic Power Systems, Inc..png",
    "Monster Beverage Corporation.png",
    "Moody’s Corporation.png",
    "Morgan Stanley.png",
    "Mosaic Company.png",
    "Motorola Solutions, Inc..png",
    "NRG Energy, Inc..png",
    "NVIDIA Corporation.png",
    "NVR, Inc..png",
    "NXP Semiconductors N.V..png",
    "Nasdaq, Inc..png",
    "NetApp, Inc..png",
    "Netflix, Inc..png",
    "Newell Brands Inc..png",
    "Newmont Corporation.png",
    "News Corporation.png",
    "NextEra Energy, Inc..png",
    "NiSource Inc.png",
    "Nike, Inc..png",
    "Nordson Corporation.png",
    "Norfolk Southern Corporation.png",
    "Northern Trust Corporation.png",
    "Northrop Grumman Corporation.png",
    "Norwegian Cruise Line Holdings Ltd..png",
    "Nucor Corporation.png",
    "ON Semiconductor Corporation.png",
    "ONEOK, Inc..png",
    "Occidental Petroleum Corporation.png",
    "Old Dominion Freight Line, Inc..png",
    "Omnicom Group Inc..png",
    "Oracle Corporation.png",
    "Organon & Co..png",
    "Otis Worldwide Corporation.png",
    "O’Reilly Automotive, Inc..png",
    "PACCAR Inc..png",
    "PNC Financial Services Group, Inc..png",
    "PPG Industries, Inc..png",
    "PPL Corporation.png",
    "PTC Inc..png",
    "Pacific Gas & Electric Co..png",
    "Packaging Corporation of America.png",
    "Palo Alto Networks, Inc..png",
    "Paramount Global.png",
    "Parker-Hannifin Corporation.png",
    "PayPal Holdings, Inc..png",
    "Paychex, Inc..png",
    "Paycom Software, Inc..png",
    "Pentair plc..png",
    "PepsiCo, Inc..png",
    "Pfizer, Inc..png",
    "Philip Morris International Inc.png",
    "Phillips 66.png",
    "Pinnacle West Capital Corporation.png",
    "Pioneer Natural Resources Company.png",
    "Pool Corporation.png",
    "Principal Financial Group Inc.png",
    "Procter & Gamble Company.png",
    "Progressive Corporation.png",
    "Prologis, Inc..png",
    "Prudential Financial, Inc..png",
    "Public Service Enterprise Group Incorporated.png",
    "Public Storage.png",
    "PulteGroup, Inc..png",
    "QUALCOMM Incorporated.png",
    "Qorvo, Inc..png",
    "Quanta Services.png",
    "Quest Diagnostics Incorporated.png",
    "RTX Corporation.png",
    "Ralph Lauren Corporation.png",
    "Raymond James Financial, Inc..png",
    "Realty Income Corporation.png",
    "Regency Centers Corporation.png",
    "Regeneron Pharmaceuticals, Inc..png",
    "Regions Financial Corporation.png",
    "Republic Services, Inc..png",
    "ResMed Inc..png",
    "Revvity, Inc..png",
    "Robert Half Inc..png",
    "Rockwell Automation, Inc..png",
    "Rollins, Inc..png",
    "Roper Technologies, Inc..png",
    "Ross Stores, Inc..png",
    "Royal Caribbean Cruises Ltd..png",
    "S&P Global Inc..png",
    "SBA Communications Corporation.png",
    "STERIS plc.png",
    "Salesforce.png",
    "Schlumberger NV.png",
    "Seagate Technology Holdings PLC.png",
    "Sealed Air Corporation.png",
    "ServiceNow, Inc..png",
    "Sherwin-Williams Company.png",
    "Simon Property Group, Inc..png",
    "Skyworks Solutions, Inc..png",
    "Snap-On Incorporated.png",
    "SolarEdge Technologies, Inc..png",
    "Southern Company.png",
    "Southwest Airlines Company.png",
    "Stanley Black & Decker, Inc..png",
    "Starbucks Corporation.png",
    "State Street Corporation.png",
    "Steel Dynamics, Inc..png",
    "Stryker Corporation.png",
    "Synchrony Financial.png",
    "Synopsys, Inc..png",
    "Sysco Corporation.png",
    "T-Mobile US, Inc..png",
    "T. Rowe Price Group, Inc..png",
    "TE Connectivity Ltd..png",
    "TJX_Logo.png",
    "Take-Two Interactive Software, Inc..png",
    "Tapestry, Inc..png",
    "Targa Resources, Inc..png",
    "Target Corporation.png",
    "Teledyne Technologies Incorporated.png",
    "Teleflex Incorporated.png",
    "Teradyne, Inc..png",
    "Tesla, Inc..png",
    "Texas Instruments Incorporated.png",
    "Textron Inc..png",
    "The AES Corporation.png",
    "The Bank of New York Mellon Corporation.png",
    "The Boeing Company.png",
    "The Cigna Group.png",
    "The Clorox Company.png",
    "The Coca-Cola Company.png",
    "The Cooper Companies, Inc..png",
    "The Estee Lauder Companies, Inc..png",
    "The Hershey Company.png",
    "The Interpublic Group of Companies, Inc..png",
    "The J.M. Smucker Company.png",
    "The Kraft Heinz Company.png",
    "The Travelers Companies, Inc..png",
    "The Walt Disney Company.png",
    "Thermo Fisher Scientific Inc.png",
    "Tractor Supply Company.png",
    "Trane Technologies plc.png",
    "Transdigm Group Inc..png",
    "Trimble Inc..png",
    "Truist Financial Corporation.png",
    "Tyler Technologies, Inc..png",
    "Tyson Foods, Inc..png",
    "U.S. Bancorp.png",
    "UDR, Inc..png",
    "Ulta Beauty, Inc..png",
    "Union Pacific Corporation.png",
    "United Airlines Holdings, Inc..png",
    "United Parcel Service, Inc..png",
    "United Rentals, Inc..png",
    "UnitedHealth Group Incorporated.png",
    "Universal Health Services, Inc..png",
    "V.F. Corporation.png",
    "VICI Properties Inc..png",
    "Valero Energy Corporation.png",
    "Ventas, Inc..png",
    "VeriSign, Inc..png",
    "Verisk Analytics, Inc..png",
    "Verizon Communications Inc..png",
    "Vertex Pharmaceuticals Incorporated.png",
    "Viatris Inc..png",
    "Visa Inc..png",
    "Vulcan Materials Company.png",
    "W.R. Berkley Corporation.png",
    "W.W. Grainger, Inc..png",
    "WEC Energy Group, Inc..png",
    "Walgreens Boots Alliance, Inc..png",
    "Walmart Inc..png",
    "Warner Bros. Discovery.png",
    "Waste Management, Inc..png",
    "Waters Corporation.png",
    "Wells Fargo & Company.png",
    "Welltower Inc..png",
    "West Pharmaceutical Services, Inc..png",
    "Western Digital Corporation.png",
    "Westinghouse Air Brake Technologies Corporation.png",
    "Westrock Company.png",
    "Weyerhaeuser Company.png",
    "Whirlpool Corporation.png",
    "Williams Companies, Inc..png",
    "Willis Towers Watson Public Limited Company.png",
    "Wynn Resorts, Limited.png",
    "Xcel Energy Inc..png",
    "Xylem Inc..png",
    "Yum! Brands, Inc..png",
    "Zebra Technologies Corporation.png",
    "Zimmer Biomet Holdings, Inc..png",
    "Zions Bancorporation N.A..png",
    "Zoetis Inc..png",
    "eBay Inc..png"
]

/**
 * Analyze the content of a news post and generate a tagline, sentiment and company logo
 * @param {object} options - The options object
 * @param {string} options.title - The title of the post
 * @param {string} options.content - The content of the post
 * @returns {object} - The result of the analysis
 * @prop {string} title - The AI generated tagline for the featured image
 * @prop {string | null} company_logo - The logo of the company we are creating the image for, if we dont have the symbol logo for it, we just return null
 * @prop {string} sentiment - The sentiment of the tagline if its positive, negative or neutral
 */
export const analyzeContent = async ({
    title, content
}) => {

    const MODEL = process.env.MODEL || 'gpt-4o';

    const response = await openai.chat.completions.create({
        model: MODEL,
        messages: [
            {
                role: 'system',
                content: `
                You are a skilled copywritter experienced in producing taglines for a financial news website.

                Your task is to analyze the data I am going to provide in the format and order of title, content and image list. You must strictly adhere to ALL of the following instructions for generating the final output. Instructions start with a "#" sign. 
                
                #1. Analyze title and content.

                #2. Give me a tagline ranging from 4 to 14 words at most that properly reflect what the article is about or make the tagline clickbaity to grab an user is attention, the tone has to be as little misterious, cannot give away too much of the content. The intent of this tagline is to  use it to produce a featured/thumbnail image. Always thrive to make it short to 6-9 words is ideal, but 10-12 words is possible. 

    
                #3. Some  words can be highlighted, wrap them with [s], highlighting is totally optional, dont highlight words if the tagline is too short or it dont need to be highlighted but if tagline is more than 6 words long, highlighting is required. Dont do multiple blocks of highlighting like [s]Words[s] that [s]shoulds[s] be [s]highlighted[s], it should be like this [s]Words that should be highlighted[s] and only happen in one line or block. In the design, this would be highligted in bold or different color. Don't wrap the whole tagline, just the one word or multiple words that can be highlighted for aesthetic purposes, there can be only one [s] block in the tagline.

                #4. highlited words must be 2 words at minimum, no 1 word highligting.

                #5. Design will hold only  from 4 to 6 words at most per line, add a mandatory [break] wrap after a ': ' color, if no colon is present, place it where it makes sense. Only add more than 1 break if tagline is less than 10 words, punctuation does not count in the word count. [br] cannot got after the first word after the colon. For example: It cannot be like "Intel's Stock Soars: What's [br] Driving the Market [br] Excitement?", it should be like "Intel's Stock Soars:[br] What's Driving the Market Excitement?"


                #6. Provide me with 1 word describing the sentiment, emotion or vibe of the article: "positive" if the article talks about gains or positive news regarding a stock  or company. "negative" if the article talks about losses or negative news regarding a stock or company. "neutral" if the article is neither positive, negative, or neutral.

                #7.
                Once you have analyzed and produced the tagline, read image list and return the corresponding url for the company or symbol the article is about. If no image is found matching the article, assign null.

                #8. The final output must be in a json format with the following structure:
                {
                tagline: "tagline generated",
                image: "filtered url",
                sentiment: "positive, negative or neutral",
                }`
            },
            {
                role: 'user',
                content: `Create the tagline and give me the image url  for the company or symbol the article is about.
                {
                title : ${title},
                content: ${content},
                image_list: ${IMAGE_LIST},
                }
                `
            }

        ],
        temperature: 0.0
    });

    const trimmed_response = response.choices[0].message.content.replace(/```json|```/g, '').trim();

    if (trimmed_response) {
        return JSON.parse(trimmed_response);
    }

    return null;

}



const TITLE = "Build-A-Bear’s Strategic Moves: Will They Deliver Impressive Growth";

const CONTENT = `

Build-A-Bear Workshop Inc.’s surprising 22.76 percent surge on Thursday follows the announcement of expanding partnerships with major retail giants and strong holiday season predictions.
Key Developments in Build-A-Bear’s Strategy

    The upcoming release of Build-A-Bear’s third-quarter fiscal 2024 results on Dec 5, 2024, follows a year of brand growth. The bear-making company fascinated investors by expanding beyond retail stores to tap into e-commerce and content creation.


`;
